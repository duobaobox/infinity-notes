# 数据管理功能测试指南

## 🚀 快速测试步骤

### 1. 启动项目
```bash
npm run dev -- --port 5174
```
访问：http://localhost:5174

### 2. 打开数据管理设置
1. 点击右上角的设置按钮（齿轮图标）
2. 在设置页面左侧选择"数据管理"标签

### 3. 查看数据统计
在数据管理页面，你可以看到：
- 📝 便签数量统计
- 🖼️ 画布数量统计  
- 💾 存储使用情况（进度条显示）

## 🧪 功能测试

### 测试1：导出数据功能
1. 点击"导出所有数据"按钮
2. 系统会自动下载一个JSON文件，文件名格式：`sticky-notes-backup-YYYY-MM-DD.json`
3. 检查下载的文件是否包含完整的数据结构

### 测试2：导入数据功能
1. 使用项目根目录下的 `test-data.json` 文件进行测试
2. 点击"导入数据"按钮
3. 选择 `test-data.json` 文件
4. 等待导入完成，应该显示"数据导入成功"消息
5. 检查画布上是否出现了3个测试便签

### 测试3：清空数据功能
1. 点击"清空所有数据"按钮
2. 系统会弹出确认对话框
3. 点击"确认清空"
4. 等待操作完成，应该显示"所有数据已清空"消息
5. 检查画布是否已清空，数据统计是否重置为0

## 🔧 错误处理测试

### 测试无效文件格式
1. 尝试导入非JSON文件（如.txt文件）
2. 应该显示"请选择JSON格式的文件"错误

### 测试大文件
1. 尝试导入超过10MB的文件
2. 应该显示"文件大小不能超过10MB"错误

### 测试损坏的JSON文件
1. 创建一个格式错误的JSON文件
2. 尝试导入，应该显示相应的错误信息

## 📊 测试数据说明

`test-data.json` 文件包含：
- 1个用户记录
- 1个画布记录
- 3个便签记录（黄色、蓝色、绿色）
- 空的标签数组
- 导出时间戳

## ✅ 预期结果

### 导出功能
- ✅ 成功下载JSON文件
- ✅ 文件包含完整的数据结构
- ✅ 文件名包含当前日期

### 导入功能  
- ✅ 成功导入测试数据
- ✅ 画布上显示3个测试便签
- ✅ 数据统计更新为正确数量
- ✅ 错误文件被正确拒绝

### 清空功能
- ✅ 显示确认对话框
- ✅ 成功清空所有数据
- ✅ 画布恢复到初始状态
- ✅ 数据统计重置为0

### 存储统计
- ✅ 实时显示便签和画布数量
- ✅ 显示存储使用情况
- ✅ 数据操作后自动更新统计

## 🐛 已修复的问题

### 日期字段处理
- **问题**：导入数据时 `createdAt.toISOString is not a function` 错误
- **原因**：JSON文件中的日期字段是字符串，不是Date对象
- **解决方案**：添加了安全的日期转换逻辑，支持字符串和Date对象

### 错误处理改进
- 添加了文件格式验证
- 添加了文件大小限制
- 改进了错误消息的用户友好性
- 添加了详细的错误日志

## 🎯 下一步改进建议

1. **增量导入**：支持合并导入而不是完全覆盖
2. **选择性导出**：允许用户选择导出特定画布或时间范围的数据
3. **数据压缩**：对大量数据进行压缩以减少文件大小
4. **导入预览**：在实际导入前显示数据预览
5. **自动备份**：定期自动导出数据到本地存储

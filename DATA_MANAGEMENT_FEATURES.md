# 数据管理功能说明

## 功能概述

项目的数据管理功能已经完成开发，移除了备份相关设置，增强了数据操作功能。所有数据都持久化存储在 IndexedDB 中，无需额外的备份机制。

## 主要功能

### 1. 数据统计显示
- **便签数量**：显示当前所有便签的总数
- **画布数量**：显示当前所有画布的总数  
- **存储使用情况**：显示 IndexedDB 存储空间的使用情况（进度条形式）

### 2. 数据导出
- **功能**：将所有数据（便签、画布、用户信息、标签等）导出为 JSON 文件
- **文件格式**：`sticky-notes-backup-YYYY-MM-DD.json`
- **包含内容**：
  - 用户信息
  - 画布数据
  - 便签数据
  - 标签数据
  - 导出时间戳

### 3. 数据导入
- **功能**：从 JSON 文件恢复数据
- **支持格式**：标准的数据导出格式
- **导入方式**：点击按钮选择文件上传
- **注意事项**：导入会覆盖现有数据

### 4. 清空所有数据
- **功能**：删除所有数据，恢复到初始状态
- **安全机制**：带确认对话框，防止误操作
- **影响范围**：删除所有便签、画布、设置等数据

## 技术实现

### 数据存储架构
- **主存储**：IndexedDB（便签、画布、AI设置、用户数据）
- **辅助存储**：localStorage（UI设置、主题、外观配置）

### 核心组件
- **SettingsModal.tsx**：设置页面主组件
- **useDatabase Hook**：数据库操作封装
- **IndexedDBService**：底层数据库服务
- **IndexedDBAdapter**：数据库适配器

### 数据管理函数
```typescript
// 加载数据统计
const loadDataStats = async () => {
  const [stats, storageInfo] = await Promise.all([
    getStats(),
    getStorageInfo(),
  ]);
  // 更新统计信息状态
};

// 导出数据
const handleExportData = async () => {
  await exportData(); // 自动下载JSON文件
};

// 导入数据
const handleImportData = async (file: File) => {
  await importData(file); // 从文件恢复数据
};

// 清空数据
const handleClearAllData = async () => {
  await clearDatabase(); // 删除所有数据
};
```

## 用户界面

### 设置页面 - 数据管理标签
1. **数据统计卡片**
   - 便签数量统计
   - 画布数量统计
   - 存储使用进度条

2. **数据操作卡片**
   - 导出按钮（蓝色主按钮）
   - 导入按钮（文件上传）
   - 清空按钮（红色危险按钮，带确认）

3. **说明信息**
   - 操作说明
   - 注意事项提醒

## 移除的功能

### 备份设置（已删除）
- ~~自动备份开关~~
- ~~备份频率设置~~
- ~~最大备份数量~~

**移除原因**：
- 数据已持久化存储在 IndexedDB 中
- 浏览器本身提供数据持久性保障
- 用户可以手动导出数据作为备份
- 简化用户界面，避免不必要的复杂性

## 使用说明

1. **查看数据统计**：打开设置 → 数据管理，查看当前数据概况
2. **导出数据**：点击"导出所有数据"按钮，自动下载备份文件
3. **导入数据**：点击"导入数据"按钮，选择之前导出的JSON文件
4. **清空数据**：点击"清空所有数据"，确认后删除所有内容

## 注意事项

- 导入操作会完全覆盖现有数据，请谨慎操作
- 清空操作不可恢复，建议先导出备份
- 数据文件包含敏感信息（如API密钥），请妥善保管
- IndexedDB 数据在浏览器中持久存储，清除浏览器数据会丢失
